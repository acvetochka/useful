# Робота з архівами

Робота з архівами в Linux зазвичай поділяється на два етапи: архівування (об'єднання файлів в один) та стиснення (зменшення розміру). Найпопулярнішим інструментом є tar, який часто комбінується з утилітами стиснення (gzip, bzip2, xz).

Нижче наведено докладний огляд основних команд та їхніх прапорців.

## 1. Універсальна утиліта tar (Tape Archiver)

Синтаксис: 
```bash
tar [опції] [назва_архіву] [файли/папки]
```

Основні режими роботи (має бути хоча б один):
- `-c (--create)`: Створити новий архів.
- `-x (--extract)`: Розпакувати файли з архіву.
- `-t (--list)`: Переглянути вміст архіву без розпакування.
- `-r (--append)`: Додати файли в кінець існуючого архіву (працює лише для нестиснутих .tar).

  Приклад:
  ```bash
  tar -rvf archive.tar new_file.txt
  ```
- `-u (--update)`: Додати лише ті файли, які новіші за копії в архіві. 

Прапорці стиснення:
- `-z (--gzip)`: Використати gzip (швидко, середнє стиснення). Розширення: .tar.gz або .tgz.
- `-j (--bzip2)`: Використати bzip2 (повільніше, краще стиснення). Розширення: .tar.bz2.
- `-J (--xz)`: Використати xz (найповільніше, але максимальне стиснення). Розширення: .tar.xz.
- `-a (--auto-compress)`: Автоматично визначити метод стиснення за розширенням файлу. 

tar не просто об’єднує файли, він дозволяє гнучко керувати ними.

Додаткові корисні прапорці:
- `-f (--file)`: Вказати ім'я файлу архіву. Має бути останнім перед назвою файлу.
- `-v (--verbose)`: Виводити список оброблюваних файлів на екран.
- `-C [шлях] (--directory)`: Змінити директорію перед виконанням операції (наприклад, розпакувати в іншу папку).
- `--exclude=[шаблон]`: Виключити певні файли або папки з архіву.
- `-X [файл]`: Виключити всі об'єкти, перелічені у файлі.

  Приклад:
  ```bash
  tar -cvzf backup.tar.gz /home/user --exclude='Downloads'.
  ```
- `-p (--preserve-permissions)`: Зберегти права доступу до файлів (важливо для системних бекапів). 
- `--atime-preserve`: Зберегти час останнього доступу
  

Приклади:

- Створити стиснутий бекап:
  ```bash
  tar -cvzf backup.tar.gz /home/user/docs
  ```
- Розпакувати в конкретну папку:
  ```bash
  tar -xvf archive.tar.xz -C /tmp/extracted
  ```
- Розархівування конкретних файлів:
  ```bash
  tar -xvf archive.tar file_to_extract.txt
  ```
  Витягти лише один файл.

Багатотомні архіви (Розбиття на частини)

Якщо архів завеликий (наприклад, для завантаження на хмару або перенесення на флешку), його можна розбити.

- Спосіб 1: Використання split (універсальний)
   Спочатку створюємо архів, потім ріжемо його:
   Створення: 
```bash
tar -cvzf - /path/to/dir | split -b 100M - backup.tar.gz.part_.
```
-b 100M: Розмір кожної частини (100 Мегабайт).
Збирання: cat backup.tar.gz.part_* > backup.tar.gz. 

Спосіб 2: Через 7z (вбудована підтримка багатотомності)
Створення: 7z a -v100m backup.7z /path/to/dir.
-v100m: Створить файли backup.7z.001, backup.7z.002 тощо.
Розпакування: Просто вкажіть перший файл: 7z x backup.7z.001. 


  
## 2. Утиліти zip та unzip
Використовуються переважно для сумісності з Windows. На відміну від tar, zip одразу і архівує, і стискає. 

Команда zip:
-r: Рекурсивне стиснення (включаючи підпапки) — обов'язково для папок.
-e: Зашифрувати архів паролем.
-q: "Тихий" режим (без виводу логів).
-9: Максимальний рівень стиснення (від 1 до 9). 
Приклад: zip -re9 my_archive.zip folder_to_zip
Команда unzip:
-l: Список файлів в архіві.
-d [шлях]: Розпакувати у вказану директорію.
-P [пароль]: Вказати пароль у командному рядку (небезпечно, краще вводити інтерактивно).
-o: Перезаписувати існуючі файли без запиту. 
Приклад: unzip archive.zip -d ./target_folder
3. Окремі утиліти стиснення (gzip, bzip2, xz)
Ці команди працюють з поодинокими файлами. Вони стискають оригінальний файл і замінюють його на архів (оригінал видаляється). 

Стиснення: gzip file.txt (створить file.txt.gz).
Розпакування: gunzip file.txt.gz, bunzip2 file.bz2 або unxz file.xz.
Прапорці:
-k (--keep): Зберегти вхідний файл (не видаляти оригінал).
-d (--decompress): Режим розпакування (аналог gunzip).
-c: Вивести результат у стандартний вивід (можна перенаправити в інший файл). 




## 3. Максимальне стиснення з 7z
Утиліта 7z часто забезпечує краще стиснення, ніж gzip чи bzip2. 
Baeldung
Baeldung
a: Додати до архіву.
-mx=9: "Ultra" рівень стиснення (від 0 до 9).
-p[password]: Встановити пароль.
-mhe=on: Зашифрувати також імена файлів (неможливо побачити вміст без пароля).
Приклад: 7z a -mx=9 -p1234 -mhe=on secret.7z ./my_folder. 


## 4. Робота з іншими форматами (RAR)
Хоча RAR — пропрієтарний формат, у Linux він доступний через пакети rar (для створення) та unrar (для розпакування).
Створення: rar a archive.rar files/.
Розпакування: unrar x archive.rar.

## 5. Автоматизація бекапів через cron
Ви можете налаштувати систему так, щоб вона робила архіви за розкладом. 
Створіть скрипт backup.sh:
bash
#!/bin/bash
DATE=$(date +%Y-%m-%d)
tar -cvzf /backups/data_$DATE.tar.gz /home/user/important_docs


Надайте права на виконання: chmod +x backup.sh.
Додайте в планувальник: Введіть crontab -e і додайте рядок:
0 2 * * * /home/user/scripts/backup.sh
(Це запускатиме бекап щодня о 02:00 ночі). 

## Порівняльна таблиця форматів
Формат	Швидкість	Рівень стиснення	Зберігає метадані Linux?
.tar.gz	Висока	Середній	Так (ідеально для системних копій)
.tar.xz	Низька	Дуже високий	Так
.zip	Середня	Низький	Ні (добре для Windows)
.7z	Низька	Найвищий	Частково (через tar.7z — так)
