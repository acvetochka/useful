# Робота з файлами

## Зміст

[Розділ 1: Робота з деревом файлів]()
  - [1.1. pwd (Print Working Directory)]()
  - [1.2. cd (Change Directory)]()
  - [1.3. ls (List)]()
  - [1.4. mkdir (Make Directory)]()
  - [1.5. cp (Copy)]()
  - [1.6. mv (Move)]()
  - [1.7. rm (Remove)]()
  - [1.8. tree]()
  - [1.9. Використання метасимволів (Wildcards)]()
  - [1.10. Розширення фігурних дужок (Brace Expansion)]()
  - [1.11. Спеціальні випадки та комбінації]()
  - [1.12. Перевірка дискового простору в дереві]()
    
[Розділ 2: Посилання (Links)]()
  - [2.1. ln (Link)]()
  - [2.2. Жорсткі посилання (Hard Links)]()
  - [2.3. Символічні посилання (Symbolic/Soft Links)]()
  - [2.4. Як розрізнити посилання (Аналіз)]()
  - [2.5. Специфічні випадки та операції]()
    - [А. Видалення посилань]()
    - [Б. Знаходження всіх жорстких посилань на файл]()
    - [В. Перевірка "битих" посилань]()
    - [Г. Відносні vs Абсолютні шляхи]()
    - [Д. Символічні посилання та cd]()


## Розділ 1: Робота з деревом файлів

У цьому розділі ми розглянемо основні утиліти: `pwd`, `cd`, `ls`, `mkdir`, `rmdir`, `cp`, `mv`, `rm` та `tree`.

### 1.1. pwd (Print Working Directory)
Показує повний абсолютний шлях до поточної директорії, в якій знаходиться користувач.

Аргументи:
- `-L` (Logical): Використовувати шлях з оточення, навіть якщо він містить символічні посилання (типово).
- `-P` (Physical): Уникати символічних посилань і показувати реальний фізичний шлях на диску.

Приклад:

- `pwd` — результат: `/home/user/documents`
- `pwd -P` — якщо ви в папці-посиланні, покаже справжню адресу папки.


### 1.2. cd (Change Directory)
Команда для переміщення між директоріями.

Спеціальні символи:
- `cd ~` або просто `cd` — перехід у домашню директорію користувача.
- `cd ..` — перехід на один рівень вгору.
- `cd -` — повернення до попередньої директорії (аналог кнопки "Назад").
- `cd /` — перехід у корінь системи.

Приклад:
- `cd /var/log` — перехід за абсолютном шляхом.
- `cd ./projects` — перехід у папку projects всередині поточної.

### 1.3. ls (List)
Виводить список файлів та підкаталогів. Одна з найбільш вживаних команд.

Аргументи:
- `-l` (long): Детальний список (права доступу, власник, розмір, дата).
- `-a` (all): Показувати приховані файли (ті, що починаються з крапки .).
- `-h` (human-readable): Відображати розмір файлів у зрозумілих одиницях (КБ, МБ, ГБ).
- `-R` (recursive): Рекурсивний вивід усіх підпапок.
- `-t` (time): Сортувати за часом останньої зміни.
- `-S`: Сортувати за розміром.

Приклад:
- `ls -lah` — вивести абсолютно всі файли з детальною інформацією у зручному форматі.
- `ls -lt /etc` — подивитися останні змінені конфігураційні файли.

### 1.4. mkdir (Make Directory)
Створення нових папок.

Аргументи:
- `-p` (parents): Створює весь ланцюжок вкладених папок, якщо вони не існують.
- `-m` (mode): Встановити права доступу (chmod) відразу при створенні.

Приклад:
- `mkdir project` — створення папки в поточній директорії.
- `mkdir -p site/assets/images` — створить три папки одну в одній одним махом.
- `mkdir -m 777 public_folder` — створить папку з повним доступом для всіх.

### 1.5. cp (Copy)
Копіювання файлів та директорій.

Аргументи:
- `-r` або `-R` (recursive): Обов'язковий для копіювання папок з їхнім вмістом.
- `-i` (interactive): Питати підтвердження перед перезаписом.
- `-u` (update): Копіювати тільки якщо вихідний файл новіший за існуючий.
- `-p` (preserve): Зберегти атрибути файлу (час, права доступу).

Приклад:
- `cp file.txt backup.txt` — копіювання файлу.
- `cp -r /home/user/work /media/usb/` — копіювання всієї папки на флешку.

### 1.6. mv (Move)
Переміщення або перейменування файлів та папок.

Аргументи:
- `-i` (interactive): Запит на підтвердження перед заміною.
- `-n` (no-clobber): Не перезаписувати існуючі файли.
- `-v` (verbose): Показувати, що саме відбувається в процесі.

Приклад:
- `mv old_name.txt new_name.txt` — перейменування.
- `mv document.pdf ~/Documents/` — переміщення у вказану папку.

### 1.7. rm (Remove)
Видалення файлів та директорій. Обережно: в терміналі немає "Кошика"!

Аргументи:
- `-r` (recursive): Видалення папки та всього її вмісту.
- `-f` (force): Видалити без запитів ігноруючи помилки.
- `-i`: Питати дозвіл перед кожним видаленням.

Приклад:
- `rm script.sh` — видалення файлу.
- `rm -rf project_folder` — повне видалення папки без зайвих питань (використовувати вкрай обережно).

### 1.8. tree
Візуалізація дерева файлів.

Аргументи:
- `-L [depth]`: Обмежити глибину відображення (наприклад, -L 2).
- `-d`: Показувати тільки директорії, ігнорувати файли.
- `-f`: Показувати повний шлях для кожного файлу.

Приклад:
- `tree -L 2` — покаже структуру папок на два рівні вглиб.

Додаємо критично важливий пласт знань про метасимволи (wildcards), дужки та спеціальні оператори, які роблять роботу з деревом файлів у десятки разів швидшою. Без них робота в терміналі — це просто заміна мишки; з ними — це автоматизація.

### 1.9. Використання метасимволів (Wildcards)
Це спеціальні символи, які дозволяють виконувати операції над групами файлів, що відповідають певному шаблону.
- `*` (Зірочка): Замінює будь-яку кількість символів (навіть нуль).

  - `ls *.txt` — показати всі текстові файли.
  - `rm -f temp_*` — видалити всі файли, що починаються на "temp_".
  - `cp *.jpg ~/Photos/` — скопіювати всі зображення в папку Photos.
- `?` (Знак питання): Замінює рівно один будь-який символ.
  - `ls file?.log` — знайде `file1.log`, `fileA.log`, але не `file10.log`.
- `[ ]` (Квадратні дужки): Визначають діапазон або набір символів.
  - `ls file[1-3].txt` — знайде file1.txt, file2.txt, file3.txt.
  - `ls [a-z]*.doc` — знайде всі документи, що починаються з малої літери.
  - `ls *.[ch]` — знайде всі файли вихідного коду C (.c або .h).

### 1.10. Розширення фігурних дужок (Brace Expansion)
Це потужний механізм генерації довільних рядків, який часто плутають із метасимволами. Він працює ще до того, як команда почне шукати файли.

Масове створення:
- `mkdir -p project/{src,bin,lib,docs}` — створить одразу 4 підпапки в директорії project.
- `touch file_{1..10}.txt` — миттєво створить 10 файлів від file_1.txt до file_10.txt.

Резервне копіювання:
- `cp config.conf{,.bak}` — швидкий спосіб зробити бекап. Розгорнеться в: `cp config.conf config.conf.bak`.

### 1.11. Спеціальні випадки та комбінації

#### А. Копіювання вмісту папки (символ /)

Важливий нюанс у командах `cp` та `rsync`:
- `cp -r folder1 folder2` — скопіює папку folder1 всередину folder2.
- `cp -r folder1/. folder2` — скопіює тільки вміст folder1 безпосередньо в folder2.

#### Б. Робота з іменами, що містять пробіли
Якщо файл називається `My Report.pdf`, команда `rm My Report.pdf` видасть помилку (вона спробує видалити два різні файли: `My` та `Report.pdf`).
- Екранування: `rm My\ Report.pdf` (зворотний слеш перед пробілом).
- Лапки: `rm "My Report.pdf"`.
- Автодоповнення: Натисніть клавішу Tab після перших літер — термінал сам підставить слеші або лапки.

#### В. "Розумне" видалення та безпека
Якщо потрібно видалити все в папці, крім одного файлу (у Bash має бути увімкнено `extglob`):
- `rm !(important.txt)` — видалити все, крім `important.txt`.
- Безпечне видалення: Багато системних адміністраторів замість rm використовують `mv file ~/.trash/` або встановлюють утиліту `trash-cli`, щоб мати можливість відновити файли.

#### Г. Потужне перейменування (rename / mmv)
Якщо mv вміє перейменовувати лише по одному файлу, то спеціальна утиліта rename (або prename) використовує регулярні вирази:
- `rename 's/\.htm$/\.html/' *.htm` — масово змінить розширення всіх файлів з .htm на .html.

### 1.12. Перевірка дискового простору в дереві
Перед масовим копіюванням чи видаленням корисно знати "вагу" гілок дерева:

du (Disk Usage):
- `du -sh *` — покаже розмір кожної папки та файлу в поточному каталозі у "людському" форматі.
- `du -ch | tail -1` — покаже загальну вагу всього дерева папок.

## Розділ 2: Посилання (Links)
Посилання — це спосіб надати одному файлу декілька імен або шляхів. Існує два основних типи: символічні (м'які) та жорсткі.

### 2.1. ln (Link)
Основна утиліта для створення посилань. За замовчуванням створює жорстке посилання.

Синтаксис: `ln [опції] <ціль> <назва_посилання>`

### 2.2. Жорсткі посилання (Hard Links)
Жорстке посилання — це, по суті, ще одне ім'я для тих самих даних на фізичному диску (однаковий номер inode).

Особливості:
- Якщо ви видалите оригінальний файл, дані залишаться доступними через жорстке посилання.
- Дані видаляються з диска лише тоді, коли видалено останнє жорстке посилання на них.
- Обмеження: Не можна створювати для директорій. Не можуть посилатися на файли на іншому диску (файловій системі).

Приклад:
- `ln file.txt hard_link.txt` — створення жорсткого посилання. Тепер обидва файли ідентичні, і зміни в одному відобразяться в іншому.

### 2.3. Символічні посилання (Symbolic/Soft Links)
Це спеціальний тип файлу, який містить лише шлях до іншого файлу або директорії (аналог ярлика в Windows).

Аргументи:
- `-s` (symbolic): Створює саме символічне посилання (найпопулярніший варіант).
- `-v` (verbose): Виводить повідомлення про кожне створене посилання.
- `-f` (force): Перезаписати існуюче посилання з таким самим ім'ям.

Особливості:
- Можуть посилатися на директорії.
- Працюють між різними дисками/розділами.
- Якщо видалити оригінал, посилання стане «битим» (pointing to nowhere).

Приклад:
- `ln -s /var/www/html/ my_site` — створення посилання на папку веб-сайту у вашій домашній директорії.
- `ln -s /usr/bin/python3 python` — створення посилання на інтерпретатор.

### 2.4. Як розрізнити посилання (Аналіз)
Для перевірки типу посилань використовуйте вже знайому команду ls:
- `ls -l`:
  - Для символічних посилань ви побачите літеру l на початку рядка прав доступу та стрілочку: `lrwxrwxrwx ... my_link -> /path/to/original`
  - Для жорстких посилань число після прав доступу (лічильник посилань) буде більше одиниці.
- `ls -i`:
  - Показує номер inode. У жорстких посилань цей номер буде абсолютно однаковим, у символічних — різним.

### 2.5. Специфічні випадки та операції
#### А. Видалення посилань
Для видалення використовується звичайна команда rm, але існує спеціалізована утиліта:
- `unlink my_link` — безпечне видалення посилання. Вона працює тільки з одним посиланням за раз і ніколи не видалить вміст директорії випадково.

#### Б. Знаходження всіх жорстких посилань на файл
Якщо ви хочете дізнатися, де ще в системі є "імена" цього самого файлу:
- `find / -samefile /path/to/file 2>/dev/null` — знайде всі жорсткі посилання за номером inode.

#### В. Перевірка "битих" посилань
Символічні посилання часто ламаються після видалення оригіналів.
- `find . -xtype l` — знайти всі "биті" символічні посилання в поточній папці.

#### Г. Відносні vs Абсолютні шляхи
При створенні символічного посилання краще використовувати абсолютний шлях:
- `ln -s ../file.txt link` — погано: якщо перемістити посилання link в іншу папку, воно зламається.
- `ln -s /home/user/file.txt link` — добре: посилання працюватиме незалежно від свого розташування.

#### Д. Символічні посилання та cd
Коли ви переходите в папку через посилання:
- `cd link_to_dir`
  - pwd покаже шлях через посилання.
  - pwd -P покаже реальне фізичне розташування папки.
