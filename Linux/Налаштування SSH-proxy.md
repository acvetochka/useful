# Налаштування SSH-proxy

## Крок 1: Налаштування Windows (Хоста)

Тут нам треба зробити так, щоб Windows дозволила Linux-машині підключитися по SSH.

1) Увімкни SSH-сервер:
- Запусти оболонку, наприклад PowerShell (Admin).
- Введи команду, щоб перевірити, чи є сервер:
  ```shell
  Get-WindowsCapability -Online | Where-Object Name -like 'OpenSSH.Server*'
  ```
- Якщо написано `NotPresent`, встанови його:
  ```shell
  Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0
  ```

  <details>
    <summary>Розбір команди встановлення SSH</summary>
    
    Команда `Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0` довга, бо це офіційний шлях через систему керування компонентами Windows (DISM).
    - `Add-WindowsCapability`: основна команда PowerShell, яка каже: "Додай нову функцію/можливість до системи".
    - `-Online`: означає, що дію треба виконати над поточною операційною системою, яка зараз запущена (а не над якимось відключеним файлом образу).
    - `-Name OpenSSH.Server~~~~0.0.1.0`: точне ім'я пакета в каталозі Microsoft.
    - `OpenSSH.Server` — назва компонента.
    - `~~~~0.0.1.0` — специфічний формат версійності Windows (чотири тильди — це технічна вимога синтаксису).
  </details>
    
- Запусти службу:
  ```shell
  Start-Service sshd
  ```
- Зроби, щоб вона запускалася сама:
  ```shell
  Set-Service -Name sshd -StartupType 'Automatic'
  ```
2) Дізнайся своє ім'я користувача Windows:

- У тому ж терміналі введи: `whoami`. Запам'ятай результат (наприклад, DESKTOP-ABC\Ivan). Для SSH тобі знадобиться саме Ivan.

3) Дізнайся IP-адресу:

- Введи `ipconfig`.
- Якщо твоя ВМ у VirtualBox (режим NAT), адреса хоста для неї зазвичай `10.0.2.2`.
- Якщо ВМ у мережевому мосту (Bridge), шукай свою IPv4 (наприклад, `192.168.x.x`).
  Примітка! Якщо в VirtualBox налаштовано переадресування порту 22 то використовуйте IPv4 адресу

## Крок 2: Налаштування Linux (Віртуальної машини)

- Тепер ідемо в термінал твоєї Linux-системи.
- Створи тунель:
  Введи команду (заміни `ivan` на своє ім'я з Кроку 1, а `10.0.2.2` на свій IP):
  ```bash
  ssh -D 1080 -N -f ivan@10.0.2.2
  ```
  Що станеться: Система запитає пароль від твого Windows-акаунта. Після введення команда "зависне" або просто поверне тебе в рядок вводу — це нормально, вона працює у фоні.
- Налаштуй DNF на роботу через цей тунель:
  Відкрий конфігураційний файл:
  ```bash
  sudo nano /etc/dnf/dnf.conf
  ```

  Допиши в самий кінець:
  ```text
  proxy=socks5h://127.0.0.1:1080
  ```

  (Натисни Ctrl+O, Enter для збереження, та Ctrl+X для виходу).

- Перевір роботу:
  ```bash
  sudo dnf clean all
  sudo dnf install fastfetch  # або будь-який інший пакет
  ```

## Короткий чек-лист "Хто де":
- На Windows: Встановити/запустити `sshd`, дізнатися IP та Username.
- На Linux: Запустити `ssh -D... `(тунель) та відредагувати `dnf.conf`.
- Маленька порада: Якщо Windows-пароль має пробіли або він порожній (що погано для SSH), краще створити на Windows тимчасового користувача з простим паролем для цього тесту.
